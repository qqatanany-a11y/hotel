{% load i18n %}
{% load crispy_forms_tags %}

<form method="get" action="{% url 'search_rooms' %}" class="search-form-enhanced">
    <div class="row g-4">
        <div class="col-lg-3 col-md-6">
            <div class="form-floating">
                <input type="date" class="form-control form-control-lg" name="check_in_date" id="id_check_in_date" 
                       value="{{ search_form.check_in_date.value|default:'' }}" placeholder="Check-in Date" required>
                <label for="id_check_in_date" class="text-dark">
                    <i class="fas fa-calendar-plus me-2"></i>Check-in Date
                </label>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6">
            <div class="form-floating">
                <input type="date" class="form-control form-control-lg" name="check_out_date" id="id_check_out_date" 
                       value="{{ search_form.check_out_date.value|default:'' }}" placeholder="Check-out Date" required>
                <label for="id_check_out_date" class="text-dark">
                    <i class="fas fa-calendar-minus me-2"></i>Check-out Date
                </label>
            </div>
        </div>
        
        <div class="col-lg-2 col-md-6">
            <div class="form-floating">
                <select class="form-select form-control-lg" name="adults" id="id_adults">
                    {% for i in "12345678910"|make_list %}
                        <option value="{{ i }}" {% if search_form.adults.value == i %}selected{% endif %}>{{ i }}</option>
                    {% endfor %}
                </select>
                <label for="id_adults" class="text-dark">
                    <i class="fas fa-user me-2"></i>Adults
                </label>
            </div>
        </div>
        
        <div class="col-lg-2 col-md-6">
            <div class="form-floating">
                <select class="form-select form-control-lg" name="children" id="id_children">
                    {% for i in "0123456789"|make_list %}
                        <option value="{{ i }}" {% if search_form.children.value == i %}selected{% endif %}>{{ i }}</option>
                    {% endfor %}
                </select>
                <label for="id_children" class="text-dark">
                    <i class="fas fa-child me-2"></i>Children
                </label>
            </div>
        </div>
        
        <div class="col-12">
            <div class="text-center mt-3">
                <button type="submit" class="btn btn-primary btn-lg search-btn" style="width: 200px;">
                    <i class="fas fa-search me-2"></i>
                    <span class="btn-text">Search</span>
                    <span class="btn-text-mobile d-lg-none">Search</span>
                </button>
            </div>
        </div>
    </div>
</form>

<style>
.search-form-enhanced {
    padding: 2rem;
    border-radius: 20px;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(15px);
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
}

.search-form-enhanced .form-floating {
    position: relative;
}

.search-form-enhanced .form-control,
.search-form-enhanced .form-select {
    border: 2px solid #e9ecef;
    border-radius: 15px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
    height: 58px;
}

.search-form-enhanced .form-control:focus,
.search-form-enhanced .form-select:focus {
    border-color: #D4AF37;
    box-shadow: 0 0 0 0.2rem rgba(212, 175, 55, 0.25);
    background: rgba(255, 255, 255, 1);
}

.search-form-enhanced .form-floating > label {
    background: none;
    padding: 0.5rem 0.75rem;
    font-weight: 500;
    color: #6c757d !important;
}

.search-btn {
    background: linear-gradient(135deg, #D4AF37 0%, #B8941F 100%);
    border: none;
    border-radius: 15px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    transition: all 0.4s ease;
    box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3);
}

.search-btn:hover {
    background: linear-gradient(135deg, #1B4B8C 0%, #D4AF37 100%);
    transform: translateY(-3px);
    box-shadow: 0 15px 35px rgba(27, 75, 140, 0.4);
}

.search-btn span.btn-text {
    font-size: 0.9rem;
}

.search-btn span.btn-text-mobile {
    display: none;
}

@media (max-width: 768px) {
    .search-form-enhanced {
        padding: 1.5rem;
    }
    
    .search-btn span.btn-text {
        display: none;
    }
    
    .search-btn span.btn-text-mobile {
        display: inline;
        font-size: 0.8rem;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const checkInDate = document.getElementById('id_check_in_date');
    const checkOutDate = document.getElementById('id_check_out_date');
    
    if (!checkInDate.value) {
        const today = new Date();
        checkInDate.value = today.toISOString().split('T')[0];
    }
    
    if (!checkOutDate.value) {
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        checkOutDate.value = tomorrow.toISOString().split('T')[0];
    }
    
    const today = new Date().toISOString().split('T')[0];
    checkInDate.min = today;
    
    checkInDate.addEventListener('change', function() {
        const checkIn = new Date(this.value);
        const nextDay = new Date(checkIn);
        nextDay.setDate(nextDay.getDate() + 1);
        
        checkOutDate.min = nextDay.toISOString().split('T')[0];
        
        if (new Date(checkOutDate.value) <= checkIn) {
            checkOutDate.value = nextDay.toISOString().split('T')[0];
        }
    });
    
    const inputs = document.querySelectorAll('.search-form-enhanced .form-control, .search-form-enhanced .form-select');
    inputs.forEach(input => {
        input.addEventListener('focus', function() {
            this.parentElement.classList.add('focused');
        });
        
        input.addEventListener('blur', function() {
            if (!this.value) {
                this.parentElement.classList.remove('focused');
            }
        });
        
        if (input.value) {
            input.parentElement.classList.add('focused');
        }
    });
    
    const searchForm = document.querySelector('.search-form-enhanced');
    const searchBtn = document.querySelector('.search-btn');
    
    searchForm.addEventListener('submit', function() {
        searchBtn.innerHTML = '<div class="loading"></div> Searching...';
        searchBtn.disabled = true;
    });
});
</script>

